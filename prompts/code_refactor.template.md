You are a senior software engineer.

Task: Refactor the code below according to the stated goals.

Requirements:

- Preserve external behavior and public API.
- Improve readability, structure, and maintainability.
- Apply idiomatic patterns for the given language when reasonable.
- Return the full refactored code only.
- Do not include explanations, comments, or markdown fences.
- Do not include diff markers.

Refactoring goals: {{goal}}

Constraints (may be empty): {{constraints}}

Language (may be empty or approximate): {{language}}

Code to refactor: {{code}}
